{"version":3,"file":"chatroom.js","sourceRoot":"","sources":["../../../src/public/scripts/chatroom.ts"],"names":[],"mappings":"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","sourcesContent":["\r\ninterface IMsg extends Usernames{\r\n\t_id: number;\r\n\tmessage: string;\r\n\ttimeSent: Date;\r\n\tread: boolean;\r\n}\r\ninterface Usernames{\r\n\tsender: string;\r\n\treceiver: string;\r\n}\r\ninterface StatusInfo {\r\n\tid: string;\r\n}\r\ninterface Typings {\r\n\tusernames: Usernames\r\n\ttyping: boolean;\r\n}\r\ninterface RegisterMessenger {\r\n\tusernames: Usernames;\r\n\tsocketId: string;\r\n}\r\ninterface RegisterInfo {\r\n\tusername: string;\r\n\tsocketId: string;\r\n}\r\ninterface OnlineInfo{\r\n  online: boolean;\r\n  username: string;\r\n}\r\ninterface StorageUser {\r\n\tusername: string;\r\n\ttoken: string;\r\n}\r\ninterface MessageCollectionOption{\r\n\tid: number;\r\n\ttext: string\r\n}\r\n\r\nconst enum props {\r\n\tmessages = 'messages',\r\n\tform = 'form',\r\n\tmsgInput = 'msgInput',\r\n\tuserOnlineDot = 'userOnlineDot'\r\n};\r\nclass Messenger{\r\n\tsocket = io();\r\n\tlastDate = '';\r\n\tmessageData: { [key: string]: string};\r\n\r\n\tuserProfileImgSmall: HTMLElement = document.querySelector('.chat-user-avatar-container-small');\r\n\tuserProfileImgBig: HTMLElement = document.querySelector('.chat-user-avatar-container-big');\r\n\tuserProfileName: NodeListOf<HTMLElement> = document.querySelectorAll('.chat-user-name');\r\n\tuserOnlineDot: NodeListOf<HTMLElement> = document.querySelectorAll('.chat-user-online-dot');\r\n\tmessages: HTMLElement = document.querySelector('#chatroom-messages');\r\n\tform: Element = document.querySelector('#chatroom-form');\r\n\tmsgInput: HTMLInputElement = <HTMLInputElement>document.querySelector('#chatroom-msg');\r\n\r\n\tconstructor(public receiver: string){}\r\n\tsetMessageData = (): void =>{\r\n\t\tthis.messageData = {\r\n\t\t\tmsg: this.msgInput && this.msgInput.value,\r\n\t\t\tsender: this.getCurrentUser().username,\r\n\t\t\treceiver: this.receiver\r\n\t\t}\r\n\t}\r\n\tresetDOMs = (propsToReset: string): void =>{\r\n\t\tswitch (propsToReset) {\r\n\t\t\tcase props.messages:\r\n\t\t\t\tthis[props.messages] = document.querySelector('#chatroom-messages');\r\n\t\t\t\tbreak;\r\n\t\t\tcase props.form:\r\n\t\t\t\tthis[props.form] = document.querySelector('#chatroom-form');\r\n\t\t\t\tbreak;\r\n\t\t\tcase props.msgInput:\r\n\t\t\t\tthis[props.msgInput] = <HTMLInputElement>document.querySelector('#chatroom-msg');\r\n\t\t\t\tbreak;\r\n\t\t\tcase props.userOnlineDot:\r\n\t\t\t\t//this[props.userOnlineDot] = document.querySelector('.user-online-dot');\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tinit = (): void => {\r\n\t\tif(!this.userAvailable()){\r\n\t\t\tthis.getLoginPage();\r\n\t\t}\t\t\t\t\r\n\t\tif(this.messages){\r\n\t\t\tthis.messages.innerHTML = 'Loading.....';\r\n\t\t}\r\n\t\tif(this.receiver === 'Welcome'){\r\n\t\t\tthis.welcomeSetup();\r\n\t\t}else{\r\n\t\t\t//initialize sockets\r\n\t\t\tthis.socketOnStatus();\r\n\t\t\tthis.socketOnOnline();\r\n\t\t\tthis.socketOnMsgSend();\r\n\t\t\tthis.socketOnMsgDelete();\r\n\t\t\tthis.socketOnReceiveTyping();\r\n\r\n\t\t\tthis.getUserStatus();\r\n\t\t\tthis.getSenderReceiverMessage();\t\t\t\r\n\r\n\t\t\tthis.onSendMessage();\r\n\t\t\tthis.onTypingRelated();\r\n\t\t}\r\n\t}\r\n\r\n\t//sockets\r\n\tsocketOnOnline = (): void =>{\r\n\t\tthis.socket.on('online', (onlineInfo: OnlineInfo)=>{\r\n\t\t\tthis.setMessageData();\r\n\t\t\tif(onlineInfo.username === this.messageData.receiver){\r\n\t\t\t\tthis.setStatus(onlineInfo.username, onlineInfo.online);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tsocketOnStatus = (): void =>{\r\n\t\tthis.socket.on('status', (info: StatusInfo)=>{\r\n\t\t\tthis.setMessageData();\r\n\t\t\tconst registerSend: RegisterMessenger = {\r\n\t\t\t\tusernames: {\r\n\t\t\t\t\tsender: this.messageData.sender,\r\n\t\t\t\t\treceiver: this.messageData.receiver\r\n\t\t\t\t},\r\n\t\t\t\tsocketId: info.id\r\n\t\t\t}\r\n\t\t\tthis.clearUnreadMsg();\r\n\t\t\tthis.socket.emit('register-chatroom', registerSend);\r\n\t\t});\r\n\t}\r\n\tsocketOnMsgSend = (): void =>{\r\n\t\tthis.socket.on('send-msg', (msg: IMsg)=>{\r\n\t\t\tmsg.timeSent = this.changeDate(msg);\r\n\t\t\tif(!this.lastDate || this.lastDate !== msg.timeSent.toDateString().substr(4)){\r\n\t\t\t\tthis.displayMsgsDate('Today');\r\n\t\t\t\tthis.lastDate = msg.timeSent.toLocaleDateString();\r\n\t\t\t}\r\n\t\t\tthis.addMessage(msg);\r\n\t\t});\r\n\t}\r\n\tsocketOnMsgDelete = (): void =>{\r\n\t\t//add feature\r\n\t\t//subtly remove delete element\r\n\t\tthis.socket.on('delete-msg', (data)=>{\r\n\t\t\tthis.removeMessage(data.msgDeleted._id);\r\n\t\t});\r\n\t}\r\n\tsocketOnDisconnect =(): void=>{\r\n\t\tthis.socket.emit('chatroom-disconnect');\r\n\t}\r\n\tsocketOnSendTyping = (typing: boolean): void=>{\r\n\t\tthis.socket.emit('typing', { \r\n\t\t\tusernames: {\r\n\t\t\t\tsender: this.messageData.sender,\r\n\t\t\t\treceiver: this.messageData.receiver\r\n\t\t\t},\r\n\t\t\ttyping: typing\r\n\t\t});\r\n\t}\r\n\tsocketOnReceiveTyping = (): void=>{\r\n\t\tthis.socket.on('io-typing', (userData: Typings)=>{\r\n\t\t\tif(userData.usernames.receiver === this.messageData.sender){\r\n\t\t\t\tif(userData.typing){\r\n\t\t\t\t\tthis.addTyping(userData.usernames.receiver);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.removeTyping();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tsocketOnClearUnread = (): void =>{\r\n\t\tsocket.on('unread-cleared', (cleared: boolean)=>{\r\n\t\t\tif(cleared){\r\n\t\t\t\t//set message to read on display\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t//DOM changers\r\n\taddMessage = (msgObj: IMsg): void => {\r\n\t\t`\t\t\r\n            <item>\r\n                <itemMainDiv>\r\n                    <itemAvatarDiv />\r\n\r\n                    <itemContentDiv>\r\n                        <itemContentWrapperDiv>\r\n                            <itemContentWrapperDivOne />\r\n\r\n                            <itemContentWrapperDivTwo>\r\n                                --inserted\r\n\r\n                                <itemDropDowmMenu>\r\n                                    <dropdowmFrag />\r\n                                </itemDropDowmMenu>\r\n                            </itemContentWrapperDivTwo>\r\n                        </itemContentWrapperDiv>\r\n\r\n                        <itemName />\r\n                    </itemContentDiv>\r\n                </itemMainDiv>\r\n            </item>\r\n\t\t`;\r\n\t\t//conversation-name\r\n\t\tconst itemName = document.createElement('div');\r\n\t\titemName.classList.add('conversation-name');\r\n\t\titemName.innerHTML = `${msgObj.sender}`;\r\n\r\n\t\tconst dropdowmFrag = new DocumentFragment();\r\n\t\tconst dropdownData = [\r\n\t\t\t{ text: 'Copy', iconClass: 'file-copy' },\r\n\t\t\t{ text: 'Save', iconClass: 'save' },\r\n\t\t\t{ text: 'Forward', iconClass: 'chat-forward' },\r\n\t\t\t{ text: 'Delete', iconClass: 'delete-bin' }\r\n\t\t];\r\n\t\tdropdownData.forEach(data=>{\r\n\t\t\tconst dropdownItem = document.createElement('span');\r\n\t\t\tdropdownItem.addEventListener('click', this.onMessageCollection.bind(this, data.text, { id: msgObj._id, text: data.text }));\r\n\t\t\t//dropdownItem.addEventListener('click', this.deleteMessage.bind(this, msgObj._id));\r\n\t\t\tdropdownItem.setAttribute('role', 'button');\r\n\t\t\tdropdownItem.classList.add('dropdown-item');\r\n\t\t\tdropdownItem.innerHTML = `\r\n            \t${data.text}\r\n            \t<i class=\"ri-${data.iconClass}-line float-end text-muted\"></i>\r\n\t\t\t`;\r\n\t\t\tdropdowmFrag.appendChild(dropdownItem);\r\n\t\t});\r\n\r\n\t\t//dropdown-menu\r\n\t\tconst itemDropDowmMenu = document.createElement('div');\r\n\t\titemDropDowmMenu.classList.add('dropdown-menu');\r\n\t\titemDropDowmMenu.appendChild(dropdowmFrag);\r\n\r\n\t\t//dropdown\r\n\t\tconst itemContentWrapperDivTwo = document.createElement('div');\r\n\t\titemContentWrapperDivTwo.classList.add('dropdown', 'align-self-start');\r\n\t\titemContentWrapperDivTwo.insertAdjacentHTML(\r\n\t\t\t'afterbegin',\r\n\t\t\t`<span class=\"dropdown-toggle dropdown-click invisible\" role=\"button\" data-bs-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n                <i class=\"ri-more-2-fill\"></i>\r\n            </span>`\r\n        );\r\n        itemContentWrapperDivTwo.insertAdjacentElement('beforeend', itemDropDowmMenu);\r\n\r\n\t\t//ctext-wrap-content\r\n\t\tconst itemContentWrapperDivOne = document.createElement('div');\r\n\t\titemContentWrapperDivOne.classList.add('ctext-wrap-content')\r\n\t\titemContentWrapperDivOne.innerHTML = `\r\n            <p class=\"mb-0\">\r\n                ${msgObj.message}\r\n            </p>\r\n            <p class=\"chat-time mb-0\"><i class=\"ri-time-line align-middle\"></i> <span class=\"align-middle\">${this.getTimeOnly(msgObj.timeSent)}</span></p>\t\t\t\r\n\t\t`;\r\n\r\n\t\t//ctext-wrap\r\n\t\tconst itemContentWrapperDiv = document.createElement('div');\r\n\t\titemContentWrapperDiv.classList.add('ctext-wrap');\r\n\t\titemContentWrapperDiv.appendChild(itemContentWrapperDivOne);\r\n\t\titemContentWrapperDiv.appendChild(itemContentWrapperDivTwo);\r\n\r\n\t\t//user-chat-content\r\n\t\tconst itemContentDiv = document.createElement('div');\r\n\t\titemContentDiv.classList.add('user-chat-content');\r\n\t\titemContentDiv.appendChild(itemContentWrapperDiv);\r\n\t\titemContentDiv.appendChild(itemName);\r\n\r\n\t\t//chat-avatar\r\n\t\tconst itemAvatarDiv = document.createElement('div');\r\n\t\titemAvatarDiv.classList.add('chat-avatar');\r\n\t\titemAvatarDiv.innerHTML = `\r\n        <span class=\"avatar-title rounded-circle bg-soft-primary text-primary\">\r\n            ${msgObj.sender.charAt(0).toUpperCase()}\r\n        </span>\r\n\t\t`;\r\n\r\n\t\t//conversation-list\r\n\t\tconst itemMainDiv = document.createElement('div');\r\n\t\titemMainDiv.classList.add('conversation-list');\r\n\t\titemMainDiv.appendChild(itemAvatarDiv);\r\n\t\titemMainDiv.appendChild(itemContentDiv);\t\t\r\n\r\n\t\tconst item = document.createElement('li');\r\n\r\n\t\titem.addEventListener('mouseover', this.onHoverMessage.bind(this));\r\n\t\titem.addEventListener('touchstart', this.onHoverMessage.bind(this));\r\n\t\titem.addEventListener('mouseleave', this.onHoverLeaveMessage.bind(this));\r\n\t\titem.addEventListener('touchend', this.onHoverLeaveMessage.bind(this));\r\n\r\n\t\titem.dataset.id = `${msgObj._id}`;\r\n\t\titem.classList.add((msgObj.sender === this.messageData.sender)?  'right': 'irrelevant');\r\n\t\titem.appendChild(itemMainDiv);\r\n\r\n\r\n\t\t//OLD\r\n\t\tthis.messages && this.messages.appendChild(item);\r\n\t\t$('.chat-conversation .simplebar-content-wrapper').scrollTop(40000);\r\n\t}\r\n\tremoveMessage = (id: string): void =>{\r\n\t\tthis.resetDOMs(props.messages);\r\n\t\tconst msgsChildren = this.messages.children;\r\n\t\tfor(let i = 0; i < msgsChildren.length; i++){\r\n\t\t\tif(msgsChildren[i].getAttribute('data-id') === id){\r\n\t\t\t\tmsgsChildren[i].remove();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\taddTyping = (whoistyping: string): void=>{\r\n\t\tlet typingExist = false;\r\n\t\tthis.resetDOMs(props.messages);\r\n\t\tconst msgsChildren = this.messages.children;\r\n\t\tfor(let i = 0; i < msgsChildren.length; i++){\r\n\t\t\tif(msgsChildren[i].getAttribute('data-id') === 'typing'){\r\n\t\t\t\ttypingExist = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t//conversation-list\r\n\t\tconst itemMainDiv = document.createElement('div');\r\n\t\titemMainDiv.classList.add('conversation-list');\r\n\t\titemMainDiv.innerHTML = `\r\n            <div class=\"chat-avatar\">\r\n                <span class=\"avatar-title rounded-circle bg-soft-primary text-primary\">\r\n\t\t            ${whoistyping.charAt(0).toUpperCase()}\r\n\t\t        </span>\r\n            </div>\r\n            \r\n            <div class=\"user-chat-content\">\r\n                <div class=\"ctext-wrap\">\r\n                    <div class=\"ctext-wrap-content\">\r\n                        <p class=\"mb-0\">\r\n                            typing\r\n                            <span class=\"animate-typing\">\r\n                                <span class=\"dot\"></span>\r\n                                <span class=\"dot\"></span>\r\n                                <span class=\"dot\"></span>\r\n                            </span>\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"conversation-name\">${whoistyping}</div>\r\n            </div>\r\n\t\t`;\r\n\t\tif(!typingExist){\r\n\t\t\tconst item = document.createElement('li');\r\n\t\t\titem.dataset.id = `typing`;\r\n\t\t\titem.appendChild(itemMainDiv);\r\n\t\t\tthis.messages && this.messages.appendChild(item);\r\n\t\t\t$('.chat-conversation .simplebar-content-wrapper').scrollTop(40000);\t\t\t\r\n\t\t}\r\n\t}\r\n\tremoveTyping = (): void=>{\r\n\t\tthis.resetDOMs(props.messages);\r\n\t\tconst msgsChildren = this.messages.children;\r\n\t\tfor(let i = 0; i < msgsChildren.length; i++){\r\n\t\t\tif(msgsChildren[i].getAttribute('data-id') === 'typing'){\r\n\t\t\t\tmsgsChildren[i].remove();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tsetStatus = (username: string, onlineStatus: boolean): void =>{\r\n\t\tthis.userProfileName[0].innerHTML = username;\r\n\t\tthis.userProfileName[1].innerHTML = username;\r\n\t\tthis.userProfileImgSmall.innerHTML = `\r\n                        <!-- <img src=\"/images/users/avatar-4.jpg\" class=\"rounded-circle avatar-xs\" alt=\"\"> -->\r\n                        <div class=\"chat-user-img online align-self-center me-1 ms-0\">\r\n\t                        <div class=\"avatar-xs\">\r\n\t\t                        <span class=\"avatar-title rounded-circle bg-soft-primary text-primary\">\r\n\t\t                            ${username.charAt(0).toUpperCase()}\r\n\t\t                        </span>\r\n\t\t                    </div>\r\n\t                    </div>\r\n\t\t`;\r\n\t\tthis.userProfileImgBig.innerHTML = `${username.charAt(0).toUpperCase()}`;\r\n\t\tif(onlineStatus){\r\n\t\t\tthis.userOnlineDot[0].classList.remove('text-warning');\r\n\t\t\tthis.userOnlineDot[0].classList.add('text-primary');\r\n\t\t\tthis.userOnlineDot[1].classList.remove('text-warning');\r\n\t\t\tthis.userOnlineDot[1].classList.add('text-primary');\r\n\t\t}else{\r\n\t\t\tthis.userOnlineDot[0].classList.add('text-warning');\r\n\t\t\tthis.userOnlineDot[0].classList.remove('text-primary');\r\n\t\t\tthis.userOnlineDot[1].classList.add('text-warning');\r\n\t\t\tthis.userOnlineDot[1].classList.remove('text-primary');\r\n\t\t}\r\n\t}\r\n\tdisplayMsgsDate = (dateToDisplay: string): void =>{\r\n\t\tconst itemMainDiv = document.createElement('div');\r\n\t\tconst content = `\r\n\t\t\t<span class=\"title\"> ${dateToDisplay} </span>\r\n\t\t`;\r\n\t\titemMainDiv.classList.add('chat-day-title');\r\n\t\titemMainDiv.innerHTML = content;\r\n\r\n\t\tconst item = document.createElement('li');\r\n\r\n\t\titem.appendChild(itemMainDiv);\r\n\t\tthis.messages && this.messages.appendChild(item);\r\n\t\twindow.scrollTo(0, document.body.scrollHeight);\r\n\t}\r\n\twelcomeSetup = (): void=>{\r\n\t\tthis.setMessageData();\r\n\t \tthis.setStatus(this.messageData.receiver, true);\r\n\t\tthis.messages.innerHTML = '';\r\n\t\tsetTimeout(()=>{\r\n\t\t\tconst firstMessage: IMsg = {\r\n\t\t\t\tsender: 'Welcome',\r\n\t\t\t\treceiver: this.getCurrentUser().username,\r\n\t\t\t\t_id: 0,\r\n\t\t\t\tread: false,\r\n\t\t\t\tmessage: `Welcome ${this.getCurrentUser().username} to my chatapp`,\r\n\t\t\t\ttimeSent: new Date(Date.now())\r\n\t\t\t};\r\n\t\t\tthis.addMessage(firstMessage);\r\n\t\t}, 2000);\r\n\t\tsetTimeout(()=>{\r\n\t\t\tconst secondMessage: IMsg = {\r\n\t\t\t\tsender: 'Welcome',\r\n\t\t\t\treceiver: this.getCurrentUser().username,\r\n\t\t\t\t_id: 0,\r\n\t\t\t\tread: false,\r\n\t\t\t\tmessage: `\r\n\t\t\t\tTo get started you can start sending messages to friends that have already signed up to our platform,\r\n\t\t\t\tall you'll need is the username, click on the add chat button <i class=\"ri-user-add-line\"></i> on the\r\n\t\t\t\thome button and youself can get started.\r\n\t\t\t\t`,\r\n\t\t\t\ttimeSent: new Date(Date.now())\r\n\t\t\t};\r\n\t\t\tthis.addMessage(secondMessage);\r\n\t\t}, 5000);\r\n\t\tsetTimeout(()=>{\r\n\t\t\tconst secondMessage: IMsg = {\r\n\t\t\t\tsender: 'Welcome',\r\n\t\t\t\treceiver: this.getCurrentUser().username,\r\n\t\t\t\t_id: 0,\r\n\t\t\t\tread: false,\r\n\t\t\t\tmessage: `\r\n\t\t\t\tP.S. You can try out leo or lenzo, and ill be there to reply your message.\r\n\t\t\t\t`,\r\n\t\t\t\ttimeSent: new Date(Date.now())\r\n\t\t\t};\r\n\t\t\tthis.addMessage(secondMessage);\r\n\t\t}, 7000);\r\n\t}\r\n\r\n\t//event listeners\r\n\tonSendMessage = (): void =>{\r\n\t\tthis.form && this.form.addEventListener('submit', (e)=>{\r\n\t\t\te.preventDefault();\r\n\t\t\tif(this.msgInput && this.msgInput.value){\r\n\t\t\t\t//this.socket.emit('message', this.nameInput.value);\r\n\t\t\t\tthis.setMessageData();\r\n\t\t\t\tthis.socketOnSendTyping(false);\r\n\t\t\t\tthis.postMessage();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tonTypingRelated = (): void=>{\r\n\t\t// Returns a function, that, as long as it continues to be invoked, will not\r\n\t\t// be triggered. The function will be called after it stops being called for\r\n\t\t// N milliseconds. If `immediate` is passed, trigger the function on the\r\n\t\t// leading edge, instead of the trailing.\r\n\t\tfunction debounce(func, wait, immediate) {\r\n\t\t\tvar timeout;\r\n\t\t\treturn function() {\r\n\t\t\t\tvar context = this, args = arguments;\r\n\t\t\t\tvar later = function() {\r\n\t\t\t\t\ttimeout = null;\r\n\t\t\t\t\tif (!immediate) func.apply(context, args);\r\n\t\t\t\t};\r\n\t\t\t\tvar callNow = immediate && !timeout;\r\n\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\ttimeout = setTimeout(later, wait);\r\n\t\t\t\tif (callNow) func.apply(context, args);\r\n\t\t\t};\r\n\t\t};\r\n\t\t//important\r\n\t\tthis.msgInput && this.msgInput.addEventListener('keydown', (e)=>{\r\n\t\t\tthis.socketOnSendTyping(true);\r\n\t\t});\r\n\t\t// This will apply the debounce effect on the keyup event\r\n\t\t// And it only fires 500ms or half a second after the user stopped typing\r\n\t\tthis.msgInput && this.msgInput.addEventListener('keyup', debounce(()=>{\r\n\t\t\tthis.socketOnSendTyping(false);\r\n\t\t}, 5000, 0));\r\n\t}\r\n\tonMessageCollection = (type: string, otherData: MessageCollectionOption, e: Element): void=>{\r\n\t\tswitch (type) {\r\n\t\t\tcase \"Delete\":\r\n\t\t\t\tthis.deleteMessage(otherData.id, e);\r\n\t\t\t\tbreak;\t\t\t\r\n\t\t\tcase \"Copy\":\r\n\t\t\t\tthis.onCopy(otherData.text, e);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// code...\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tonCopy = (text: string, e: Element): void=>{\r\n\t\tconst fallbackCopy = (text: string): void=>{\r\n\t\t\tlet textArea = document.createElement('textarea');\r\n\t\t\ttextArea.value = text;\r\n\r\n\t\t\ttextArea.style.top = '0';\r\n\t\t\ttextArea.style.left = '0';\r\n\t\t\ttextArea.style.position = 'fixed';\r\n\t\t\tdocument.appendChild(textArea);\r\n\t\t\ttextArea.focus();\r\n\t\t\ttextArea.select();\r\n\t\t\ttextArea.setSelectionRange(0, 9999999);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tvar successful = document.execCommand('copy');\r\n\t\t\t\tvar msg = successful ? 'successful' : 'unsuccessful';\r\n\t\t\t\t//console.log('Fallback: Copying text command was ' + msg);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('Fallback: Oops, unable to copy', err);\r\n\t\t\t}\r\n\t\t\tdocument.body.removeChild(textArea);\r\n\t\t}\r\n\t\tif (!navigator.clipboard) {\r\n\t\t\tfallbackCopy(text);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnavigator.clipboard.writeText(text).then(function() {\r\n\t\t\t//console.log('Async: Copying to clipboard was successful!');\r\n\t\t}, function(err) {\r\n\t\t\tconsole.error('Async: Could not copy text: ', err);\r\n\t\t});\r\n\t}\r\n\tonHoverMessage = (e: Event): void=>{\r\n\t\t//console.log(e.type);\r\n\t\t//console.log(e.target);\r\n\t\tconst dropdown = <Element>e.target;\r\n\t\tif(dropdown.classList.contains('ctext-wrap-content')){\r\n\t\t\tdropdown.nextElementSibling.children[0].classList.add('visible');\r\n\t\t\tdropdown.nextElementSibling.children[0].classList.remove('invisible');\r\n\t\t\tsetTimeout(()=>{\r\n\t\t\t\tdropdown.nextElementSibling.children[0].classList.remove('visible');\r\n\t\t\t\tdropdown.nextElementSibling.children[0].classList.add('invisible');\r\n\t\t\t}, 20000);\r\n\t\t}\r\n\t}\r\n\tonHoverLeaveMessage = (e: Event): void=>{\r\n\t\tconst dropdown = <Element>e.target;\r\n\t\tif(dropdown.classList.contains('ctext-wrap-content')){\r\n\t\t\tdropdown.nextElementSibling.children[0].classList.remove('visible');\r\n\t\t\tdropdown.nextElementSibling.children[0].classList.add('invisible');\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\t//ajax\r\n\tdeleteMessage = (id: number, e: Element) =>{\r\n\t\t$.ajax({\r\n\t\t\turl: `/api/message/${id}`,\r\n\t\t\ttype: 'DELETE'\r\n\t\t}).done(response=>{\r\n\t\t\t//console.log(response);\r\n\t\t}).fail(err=>{\r\n\t\t\tconsole.log(err);\r\n\t\t});\r\n\t}\r\n\tgetAllMessages = (): void => {\r\n\t\tthis.messages.innerHTML = '';\r\n\t\t$.get('/api/messages/all')\r\n\t\t .done((response)=>{\r\n\t\t \tconst messages: IMsg[] = response.data.messages;\r\n\t\t \tif(messages.length === 0){\r\n\t\t \t\tthis.messages.innerHTML = 'Welcome to your chatroom, use the input box below to start sending your messages';\r\n\t\t \t}\r\n\t\t \tmessages.forEach((msg: IMsg)=>{\r\n\t\t\t\tmsg.timeSent = this.changeDate(msg);\r\n\t\t \t\tthis.addMessage(msg);\r\n\t\t \t});\r\n\t\t }).fail(err=>{\r\n\t\t \tconsole.log(err);\r\n\t\t });\r\n\t}\r\n\tgetSenderReceiverMessage = (): void => {\r\n\t\tif(this.messages){\r\n\t\t\tthis.messages.innerHTML = '';\r\n\t\t}\r\n\t\tconst { sender, receiver} = this.messageData;\r\n\t\t$.get(`/api/messages/all/${sender}/${receiver}`)\r\n\t\t .done((response)=>{\r\n\t\t \tconst messages: IMsg[] = response.data.messages;\r\n\t\t \tif(messages.length === 0){\r\n\t\t \t\tthis.messages.innerHTML = 'Welcome to your chatroom, use the input box below to start sending your messages';\r\n\t\t \t}\r\n\t\t\tthis.lastDate = '';\r\n\t\t \tmessages.forEach(msg=>{\r\n\t\t\t\tmsg.timeSent = this.changeDate(msg);\r\n\t\t\t\tlet today  = new Date().toDateString().substr(4);\r\n\t\t\t\tif(today !== msg.timeSent.toDateString().substr(4)){\r\n\t\t\t\t\tif(!this.lastDate || this.lastDate !== msg.timeSent.toDateString().substr(4)){\r\n\t\t\t\t\t\tthis.displayMsgsDate(msg.timeSent.toDateString().substr(4));\r\n\t\t\t\t\t\tthis.lastDate = msg.timeSent.toDateString().substr(4);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(!this.lastDate || this.lastDate !== msg.timeSent.toDateString().substr(4)){\r\n\t\t\t\t\t\tthis.displayMsgsDate('Today');\r\n\t\t\t\t\t\tthis.lastDate = msg.timeSent.toDateString().substr(4);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.addMessage(msg);\r\n\t\t \t});\r\n\t\t\t$('.chat-conversation .simplebar-content-wrapper').scrollTop(4000);\r\n\t\t }).fail(err=>{\r\n\t\t \tconsole.log(err);\r\n\t\t });\r\n\t}\r\n\tgetUserStatus = (): void =>{\r\n\t\tthis.setMessageData();\r\n\t\t$.get(`/auth/status/${this.messageData.receiver}`)\r\n\t\t .done(response=>{\r\n\t\t \tthis.setStatus(this.messageData.receiver, response.data.status);\r\n\t\t })\r\n\t\t .fail(err=>{\r\n\t\t \tconsole.log(err);\r\n\t\t });\r\n\t}\r\n\tpostMessage = (): void =>{\r\n\t\t$.post('/api/message', this.messageData)\r\n\t\t .done((response)=>{\r\n\t\t\tif(response.data.success){\r\n\t\t\t\tthis.msgInput.value = '';\r\n\t\t\t}\r\n\t\t }).fail(err=>{\r\n\t\t\tconsole.log(err);\r\n\t\t });\r\n\t}\r\n\tclearUnreadMsg = (): void=>{\r\n\t\tconst data = {\r\n\t\t\tsender: this.messageData.sender,\r\n\t\t\treceiver: this.messageData.receiver\r\n\t\t};\r\n\t\t$.post('/api/user/clear-unread', data)\r\n\t\t .done((response)=>{\r\n\t\t \tif(response.data.success){\r\n\r\n\t\t \t}\r\n\t\t }).fail(err=>{\r\n\t\t\tconsole.log(err);\r\n\t\t });\r\n\t}\r\n\r\n\t//utils\r\n\tchangeDate = (msg: IMsg): Date =>{ return new Date(msg.timeSent); }\r\n\tgetTimeOnly = (dateObj: Date): string =>{ \r\n\t\treturn `\r\n\t\t\t${dateObj.getHours()}:${(dateObj.getMinutes()<10)? \r\n\t\t\t\t'0' + dateObj.getMinutes(): dateObj.getMinutes()}\r\n\t\t`; \r\n\t}\r\n    getCurrentUser = (): StorageUser=>{\r\n    \treturn JSON.parse(localStorage.getItem('chatapp-user'));\r\n    }\r\n    userAvailable = (): boolean=>{\r\n    \tif(JSON.parse(localStorage.getItem('chatapp-user'))){\r\n    \t\treturn true;\r\n    \t}\r\n    \treturn false;\r\n    }\r\n\tgetIndexPage = (): void =>{\r\n\t\twindow.location.href = '/';\r\n\t}\r\n\tgetLoginPage = (): void =>{\r\n\t\twindow.location.href = '/login';\r\n\t}\r\n}\r\n//const msg = new Messenger();\r\n//msg.init();"]}